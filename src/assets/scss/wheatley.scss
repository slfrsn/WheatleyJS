// Variables
$portal-color-blue: #7cb6ff;
$portal-color-orange: #F4AF3F;

// contrast(1.4) saturate(1.4) brightness(0.9)

// Functions
@function adjust-lightness($color, $gamma) {
  @if $gamma <= -1% { $color: darken($color, $gamma * -1); }
	@if $gamma >=  1% { $color: lighten($color, $gamma); }
	@if $gamma >=  0% { $color: $color; }
  @return darken(saturate($color, 100%), 10%);
}

// Mixins
@mixin portal-entrance($color, $gamma) {
  $adjusted-color: adjust-lightness($color, $gamma);
  background: radial-gradient(ellipse,
    adjust-lightness($adjusted-color, -60%) 10%,
    adjust-lightness($adjusted-color, -59%) 20%,
    adjust-lightness($adjusted-color, -53%) 42%,
    adjust-lightness($adjusted-color, -48%) 58%,
    adjust-lightness($adjusted-color, -40%) 100%
  );
}
@mixin portal-layer($scale-x, $scale-y, $gamma, $rotation, $duration, $timing) {
  width: 100% * $scale-x;
  height: 100% * $scale-y;
  transform: translate(-50%, -50%) rotate($rotation);
  animation-duration: $duration !important;
  animation-timing-function: $timing !important;
  #blue-portal & {
    background: adjust-lightness($portal-color-blue, $gamma);
    box-shadow: 0 0 20px rgba(adjust-lightness($portal-color-blue, $gamma), 0.4);
  }
  #orange-portal & {
    background: adjust-lightness($portal-color-orange, $gamma);
    box-shadow: 0 0 20px rgba(adjust-lightness($portal-color-orange, $gamma), 0.4)
  }
}

.wheatley-container, .wheatley-portal, .wheatley-portal div {
	user-select: none !important;
	cursor: none !important;
}

// PORTAL CROSSHAIR STYLES

#wheatley-crosshair {
	position: absolute;
  display: none;
	z-index: 9;
  background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 138 177" xmlns="http://www.w3.org/2000/svg"><circle cx="961.2" cy="580.7" r="1.9" fill="#aaa" transform="translate(-508.354 -259.685) scale(.6016)"/><circle cx="961.2" cy="580.7" r="1.9" fill="#aaa" transform="translate(-508.354 -280.21) scale(.6016)"/><circle cx="961.2" cy="580.7" r="1.9" fill="#aaa" transform="translate(-508.28 -239.86) scale(.6016)"/><circle cx="961.2" cy="580.7" r="1.9" fill="#aaa" transform="translate(-532.125 -259.685) scale(.6016)"/><circle cx="961.2" cy="580.7" r="1.9" fill="#aaa" transform="translate(-484.133 -259.685) scale(.6016)"/><path d="M896.3 630.4c-13.5-78 44.6-146 99.5-99.4 10 8.5 4.6 8-2.6 5.2-45-18.4-89 38.6-89.6 94.7 0 17-4.5 15.2-7.3-1z" fill="none" stroke-width="3.5" stroke="#7cb6ff" transform="matrix(.9792 0 0 1.0215 -872.663 -523.762)"/><path d="M896.3 630.4c-13.5-78 44.6-146 99.5-99.4 10 8.5 4.6 8-2.6 5.2-45-18.4-89 38.6-89.6 94.7 0 17-4.5 15.2-7.3-1z" fill="none" stroke-width="3.5" stroke="#f9ba4c" transform="matrix(-.9792 0 0 -1.0215 1010.215 700.685)"/></svg>') no-repeat;
  width: 125px;
  height: 125px;
	pointer-events: none;
  &.blue:before, &.orange:after {
    content: '';
    width: 100%;
    height: 100%;
    position: absolute;
  }
  &.blue:before {
    background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 138 177" xmlns="http://www.w3.org/2000/svg"><path d="M8 118.4C0 51.8 40.6-18.6 95 18.2 53 5 10.7 56.7 8 118.4z" fill="#7cb6ff"/></svg>') no-repeat;
  }
  &.orange:after {
    background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 138 177" xmlns="http://www.w3.org/2000/svg"><path d="M129.5 58.5c8.2 66.6-32.4 137-87 100.3 42.3 13.2 84.4-38.6 87-100.3z" fill="#f9ba4c"/></svg>') no-repeat;
  }
}

// PORTAL STYLES

.wheatley-portal {
  position: absolute;
	width: 100px;
	height: 100px;
  transform: scaleY(1.3);
	animation-name: 'appear';
	animation-duration: 0.2s;
	animation-timing-function: ease;
  & > div {
    position: absolute;
    margin-top: 50%;
    margin-left: 50%;
    border-radius: 50%;
  	animation-name: 'spin';
  	animation-duration: 0.2s;
  	animation-timing-function: ease;
    animation-iteration-count: infinite;
  }
}
.darkest  { @include portal-layer(0.90, 1.00, -15%,  90deg, 0.8s, linear); }
.darker   { @include portal-layer(0.90, 1.00, -10%,  45deg, 0.2s, linear); }
.normal   { @include portal-layer(0.90, 1.00,   0%,   0deg, 0.5s, linear); }
.lighter  { @include portal-layer(0.90, 1.00,  10%, -45deg, 1.1s, linear); }
.lightest { @include portal-layer(0.90, 1.00,  15%, -90deg, 0.8s, linear); }
.entrance { @include portal-layer(0.87, 0.85, -60%,   0deg, 0.1s, ease);
  box-shadow: 0 0 20px #fff !important;
  #blue-portal &   { @include portal-entrance($portal-color-blue, 8%); }
  #orange-portal & { @include portal-entrance($portal-color-orange, 15%); }
}

// ANIMATIONS

.appear {
	animation-name: 'appear';
	animation-duration: 0.2s;
	animation-timing-function: ease;
}
@keyframes appear {
  0%   { transform: scale( 0,   0); opacity:   0; }
  25%  { transform: scale(.8, 1.2); opacity: .25; }
  50%  { transform: scale(.9, 1.1); opacity: .50; }
  100% { transform: scale( 1, 1.3); opacity:   1; }
}

.disappear {
	animation-name: 'disappear';
	animation-duration: 0.2s;
	animation-timing-function: ease;
}
@keyframes disappear {
  0%   { transform: scale( 1, 1.3); opacity:   1; }
  25%  { transform: scale(.8, 1.1); opacity: .75; }
  50%  { transform: scale(.9, 1.2); opacity: .25; }
  100% { transform: scale( 0,   0); opacity:   0; }
}

.misfire {
	animation-name: 'misfire';
	animation-duration: 0.2s;
	animation-timing-function: ease;
}
@keyframes misfire {
  0%   { transform: rotate( 0deg); }
  25%  { transform: rotate( 3deg); }
  40%  { transform: rotate(-3deg); }
  50%  { transform: rotate( 3deg); }
  100% { transform: rotate( 0deg); }
}

@keyframes spin {
  0%   { transform: translate(-50%, -50%) rotate(  0deg); }
  100% { transform: translate(-50%, -50%) rotate(360deg); }
}
